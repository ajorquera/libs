(function(s,c){typeof exports=="object"&&typeof module<"u"?c(exports,require("react/jsx-runtime"),require("react"),require("firebase/firestore")):typeof define=="function"&&define.amd?define(["exports","react/jsx-runtime","react","firebase/firestore"],c):(s=typeof globalThis<"u"?globalThis:s||self,c(s.react={},s["react/jsx-runtime"],s.react,s["firebase/firestore"]))})(this,function(s,c,d,i){"use strict";var O=Object.defineProperty;var H=(s,c,d)=>c in s?O(s,c,{enumerable:!0,configurable:!0,writable:!0,value:d}):s[c]=d;var S=(s,c,d)=>H(s,typeof c!="symbol"?c+"":c,d);function f(...n){return t=>n.reduce((e,o)=>o(e),t)}const a=(n,t)=>e=>(t.forEach(o=>{(e[n]??e[o])!==void 0&&(e[n]=e[n]??e[o])}),e),h=n=>t=>{const e={...t};return n.forEach(o=>delete e[o]),e},R=n=>{const t=f(a("marginTop",["marginTop","mt","my"]),a("marginRight",["marginRight","mr","mx"]),a("marginBottom",["marginBottom","mb","my"]),a("marginLeft",["marginLeft","ml","mx"]),a("margin",["margin","m"]))({...n});return{...h(["marginTop","marginRight","marginBottom","marginLeft","margin","mt","mr","mb","ml","my","mx"])(n),style:{...n.style,...t}}},P=n=>{const t=f(a("paddingTop",["paddingTop","pt","py"]),a("paddingRight",["paddingRight","pr","px"]),a("paddingBottom",["paddingBottom","pb","py"]),a("paddingLeft",["paddingLeft","pl","px"]),a("padding",["padding","p"]))({...n});return{...h(["paddingTop","paddingRight","paddingBottom","paddingLeft","padding","pt","pr","pb","pl","px","py"])(n),style:{...n.style,...t}}},x=n=>{const t=f(a("width",["width","w"]),a("height",["height","h"]),a("minWidth",["minWidth","minW"]),a("minHeight",["minHeight","minH"]))({...n});return{...h(["width","height","minWidth","minHeight"])(n),style:{...n.style,...t}}},B=n=>{const t=f(a("borderTop",["borderTop","borderY"]),a("borderRight",["borderRight","borderX"]),a("borderBottom",["borderBottom","borderY"]),a("borderLeft",["borderLeft","borderX"]))({...n});return{...h(["borderTop","borderRadius","borderRight","borderBottom","borderLeft","borderY","borderX"])(t),style:{...n.style,...t}}},T=n=>{const t=f(a("backgroundColor",["backgroundColor","bg"]))({...n});return{...h(["backgroundColor","bg"])(n),style:{...t,...n.style}}},L=({as:n,style:t,...e})=>{const o=f(R,P,x,B,T)(e),r=n??"div";return c.jsx(r,{...o,style:{...o.style,...t}})},q=()=>c.jsx("span",{children:"Text"}),v=({children:n,...t})=>c.jsx("button",{...t,children:n}),D=(n,t)=>n.reduce((e,o)=>(e[o.name]=t,e),{}),E=n=>async(t,e)=>{const o=Object.fromEntries(e.entries());n(o)},j=({onSubmit:n,error:t,fields:e,componentMap:o})=>{const[r,l,y]=d.useActionState(E(n),D(e,"")),g=t||Object.values(r).pop();return c.jsxs("form",{action:l,children:[e.map((m,u)=>{const b=o[m.type]??o.default;return c.jsx(b,{label:m.label,...m.options},u)}),g&&c.jsx(q,{children:g}),c.jsx(v,{type:"submit",children:y?"Loading...":"Submit"})]})};function F(n,{inmediate:t}={inmediate:!1}){const[e,o]=d.useState(null),[r,l]=d.useState(null),[y,g]=d.useState(!1),m=d.useRef(!0);d.useEffect(()=>()=>{m.current=!1},[]);const u=d.useCallback(async(...b)=>{m.current&&(g(!0),l(null),o(null),n(...b).then(p=>o(p)).catch(p=>l(p)).finally(()=>g(!1)))},[]);return d.useEffect(()=>{t&&u()},[t,u]),{data:e,error:r,loading:y,execute:u}}function C(n,t={disabled:!1}){const[e,o]=d.useState(null),[r,l]=d.useState(!1),[y,g]=d.useState(null);return d.useEffect(()=>{if(!t.disabled){l(!0);const m=i.onSnapshot(n,u=>{if(u instanceof i.DocumentSnapshot)u.exists()&&o(null),o(u.data());else if(u.empty)o([]);else{const b=u.docs.map(w=>w.data());o(b)}l(!1)},u=>{g(u),l(!1)});return()=>m()}},[JSON.stringify(n),t.disabled]),{data:e,loading:r,error:y}}class A{constructor(t,e){S(this,"collectionName");this.collectionRef=t,this.db=e,this.collectionName=this.collectionRef.path}query(t){return(...e)=>{let o;if(typeof e[0]=="string"){const[r]=e;o=i.doc(t,r)}else if(e.some(r=>r.every(Boolean))){const r=e.map(l=>i.where(...l));o=i.query(t,...r)}else o=i.query(t);return o}}async create(t){const e=i.doc(this.collectionRef),o={...t,id:e.id,createdAt:i.Timestamp.now()};return await i.setDoc(e,o),o}async read(t){const e=i.doc(this.collectionRef,t);let o;if(t){const r=await i.getDoc(e);r.exists()&&(o=r.data())}else{const r=await i.getDocs(this.collectionRef);r.empty||(o=r.docs.map(l=>l.data()))}return o}async update(t,e){const o=i.doc(this.collectionRef,t);await i.setDoc(o,e,{merge:!0})}async delete(t){const e=i.doc(this.collectionRef,t);await i.deleteDoc(e)}async deleteAll(...t){const e=t.map(r=>i.where(...r)),o=await i.getDocs(i.query(this.collectionRef,...e));if(this.db||console.error("db is not available"),!o.empty&&this.db){const r=i.writeBatch(this.db);o.forEach(l=>{r.delete(l.ref)}),await r.commit()}}}s.Box=L,s.FireCrud=A,s.Form=j,s.useAsync=F,s.useFirequery=C,Object.defineProperty(s,Symbol.toStringTag,{value:"Module"})});
